---
title: ScrollTrigger.refresh
---
[[toc]]


ğŸ“š å®šä¹‰ï¼š

`ScrollTrigger.addEventListener(safe: Boolean)` 
- å¯¹é¡µé¢ä¸­æ‰€æœ‰çš„ScrollTriggeréƒ½é‡æ–°è®¡ç®—ä½ç½®ã€‚å½“window/scroller resizeæ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨å‘ç”Ÿã€‚ä½†æ˜¯ä½ ä¹Ÿå¯ä»¥é€šè¿‡è°ƒç”¨ `ScrollTrigger.refresh()` å¼ºåˆ¶åˆ·æ–°ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ å¯¹DOMè¿›è¡Œæ›´æ”¹ï¼Œå°†å¯¼è‡´å›æµå’Œä½ç½®æ›´æ”¹(å¦‚å±•å¼€å†…å®¹)ã€‚
- å‚æ•°
  - `safe: Boolean` : å¦‚æœä¸º `true`ï¼Œå®ƒè‡³å°‘ç­‰å¾…ä¸€ä¸ªrequestAnimationFrame tickï¼Œå¤§çº¦200msåå¼€å§‹åˆ·æ–°ã€‚è¿™å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºæœ‰æ—¶æµè§ˆå™¨å®é™…ä¸Šä¸ä¼šç«‹å³å‘ˆç°domç›¸å…³çš„æ›´æ”¹ï¼Œä»è€Œå¯¼è‡´æµ‹é‡ä¸å‡†ç¡®ã€‚
  - ä¾‹å¦‚ï¼Œå¦‚æœä½ ç»™ä¸€ä¸ªå¯ä»¥å±•å¼€å…¶å†…å®¹çš„å…ƒç´ æ·»åŠ  `click` äº‹ä»¶ï¼Œå¹¶ä¸”ä½ åœ¨äº‹ä»¶å›è°ƒä¸­è°ƒç”¨ `ScrollTrigger.refresh()`ï¼Œè¿™ä¸ªæ”¹å˜å¯èƒ½åœ¨é‚£ä¸ªæ—¶é—´ç‚¹è¿˜æ²¡æœ‰å®Œå…¨æ¸²æŸ“ï¼Œå› æ­¤è¿™é‡Œæ˜¯å¾ˆé€‚åˆå¼€å¯ `safe` ğŸ˜


## åˆ·æ–°æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ
æ¯ä¸ªScrollTriggeréƒ½ä¼šè¿›è¡Œå¦‚ä¸‹æ­¥éª¤ï¼ˆæŒ‰å®ä¾‹åˆ›å»ºçš„é¡ºåºï¼‰ï¼š
1. `refreshInit` äº‹ä»¶è¢«è§¦å‘
2. ä»»ä½•å›ºå®šå…ƒç´ ï¼ˆ`pinned elements`ï¼‰ä¼šä¸´æ—¶å›é€€åˆ°å®ƒä»¬éå›ºå®šçŠ¶æ€ï¼ˆå®ƒä»¬åœ¨æ–‡æ¡£ä¸­çš„è‡ªç„¶ä½ç½®ï¼‰
3. å¦‚æœä½¿ç”¨äº† `scrub`ï¼ŒåŠ¨ç”»ä¼šä¸´æ—¶é‡ç½®åˆ°å¼€å§‹çŠ¶æ€
4. ScrollTriggerçš„start & endä½ç½®ä¼šåŸºäºå…¶å½“å‰DOM(è‡ªç„¶æµ)è¿›è¡Œé‡æ–°è®¡ç®—ã€‚è¿™ä¹Ÿæ„å‘³ç€ï¼Œå¦‚æœä½ ä½¿ç”¨äº†åŸºäºå‡½æ•°çš„ `start` | `end` å€¼ï¼Œå®ƒä»¬ä¹Ÿä¼šè¢«è°ƒç”¨ğŸ¤©
5. ä»»ä½•å›ºå®šå…ƒç´ å’ŒåŠ¨ç”»ä¼šä¾æ®å®ƒä»¬çš„æ–°çš„ä½ç½®æˆ–è¿›åº¦é‡å¯ï¼ˆre-enableï¼‰
6. å¦‚æœè¿›åº¦ï¼ˆprogressï¼‰å‘ç”Ÿå˜åŒ–ï¼Œ`update()`å›è°ƒå‡½æ•°ä¼šè¢«è°ƒç”¨
7. ScrollTriggerå®ä¾‹çš„ `onRefresh` å›è°ƒè¢«è§¦å‘


## é«˜çº§ï¼šç›‘å¬ refresh|refreshInit äº‹ä»¶
ScrollTriggerä¼šåœ¨æ‰€æœ‰ScrollTriggersåˆ·æ–°å‰ç«‹å³æ‰§è¡Œ `refreshInit` äº‹ä»¶ï¼Œåœ¨æ‰€æœ‰ScrollTriggersåˆ·æ–°åç«‹å³æ‰§è¡Œ `refresh` äº‹ä»¶ã€‚ ä½ å¯ä»¥æ·»åŠ ä¸€ä¸ª [äº‹ä»¶ç›‘å¬å™¨](./static-addEventListener)ï¼š
```js {2,6}
ScrollTrigger.addEventListener('refreshInit', function() {
  // è¿™ä¸ªäº‹ä»¶åœ¨åˆ·æ–°å‰è°ƒç”¨
})

ScrollTrigger.addEventListener('refresh', function() {
  // è¿™ä¸ªäº‹ä»¶åœ¨æ‰€æœ‰ScrollTriggersåˆ·æ–°åè°ƒç”¨
})
```

è¿™äº›äº‹ä»¶éƒ½æ˜¯ `å…¨å±€` å‘é€çš„ï¼Œè€Œä¸æ˜¯ç»‘å®šæŸä¸ªç‰¹å®šScrollTriggerçš„
ğŸŒ°
```js
ScrollTrigger.addEventListener(
  'scrollEnd',
  () => console.log('Scrolling Ended!')
)
```
åŒæ—¶è¿˜æœ‰ä¸€ä¸ª[ç§»é™¤äº‹ä»¶ç›‘å¬](./static-removeEventListener)çš„æ–¹æ³•ã€‚æ³¨æ„ï¼Œè¿™äº›æ–¹æ³•éƒ½æ˜¯ `é™æ€çš„`


## refresh() å’Œ update() çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ
`refresh()` æ˜¯å…³äºScrollTrigger `start | end` ä½ç½®ä¾æ®å½“å‰DOMé‡æ–°è®¡ç®—ï¼›è€Œ `update()` ç®€å•çš„æ£€æŸ¥scrolleræ»šåŠ¨ä½ç½®å¹¶æ›´æ–°ç›¸å…³è”çš„åŠ¨ç”»å’Œè§¦å‘å›è°ƒï¼ˆå¦‚æœå¿…è¦çš„è¯ï¼‰ã€‚
å› æ­¤ï¼Œ`refresh()` è®¾è®¡æ›´å¤šçš„å·¥ä½œï¼Œå®ƒä¹Ÿä¼šæœ€ç»ˆè°ƒç”¨ `update()`ã€‚ å½“DOMæ”¹å˜æˆ–è€…ä½ éœ€è¦å¼ºåˆ¶é‡æ–°è®¡ç®— `start|end` ä½ç½®æ—¶ï¼Œä½ æ‰ä¼šå»è°ƒç”¨ `refresh()`ã€‚


æ–‡æ¡£åœ°å€ï¼š

- [ScrollTrigger.refresh()](https://greensock.com/docs/v3/Plugins/ScrollTrigger/static.refresh())


2022å¹´10æœˆ20æ—¥17:40:12
